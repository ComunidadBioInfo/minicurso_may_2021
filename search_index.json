[["index.html", "Mini curso mayo 2021: plotly e iSEE General C√≥digo de Conducta Datos Generales Descripci√≥n Pre-requisitos Para qui√©n va dirigido este mini curso Actividades Organizadores Formulario de registro Informaci√≥n sesi√≥n de R Licencia", " Mini curso mayo 2021: plotly e iSEE Michael Jeziorski Universidad Nacional Aut√≥noma de M√©xicoLeonardo Collado-Torres Lieber Institute for Brain Development, Johns Hopkins Medical Campus General Este es el material del mini curso ‚ÄúExploraci√≥n interactiva de datos: plotly y iSEE‚Äù ofrecido por la Red Mexicana de Bioinform√°tica (RMB) y la Comunidad de Desarrolladores de Software en Bioinform√°tica (CDSB). Fecha: 14 de mayo de 2021 Instructores: Dr.¬†Michael Jeziorski Dr.¬†Leonardo Collado-Torres C√≥digo de Conducta Seguiremos el c√≥digo de conducta de la CDSB M√©xico comunidadbioinfo.github.io/es/codigo-de-conducta/ adem√°s del c√≥digo de conducta de Bioconductor bioconductor.org/about/code-of-conduct/. Datos Generales Duraci√≥n: 2 horas Nivel: Intermedio Idioma: Espa√±ol e Ingl√©s Fecha: 14 de mayo de 2021 Horario: 16:00 a 18:00 (Centro de M√©xico) Modalidad: Online Descripci√≥n Este mini curso va dirigido a personas que han usado R para generar gr√°ficas con paquetes de R para visualizaci√≥n como ggplot2. ggplot2 es una excelente herramienta de visualizaci√≥n para cualquier tipo de datos. Sin embargo, ggplot2 genera gr√°ficas est√°ticas que no permiten explorar de forma interactiva los datos una vez que ya est√° generada la imagen. Por lo tanto, aprenderemos a usar plotly para convertir las gr√°ficas est√°ticas generadas por ggplot2 en gr√°ficas interactivas y de los beneficios que estas visualizaciones proveen. Adem√°s, en este mini curso aprenderemos a visualizar de forma interactiva datos de RNA-seq y scRNA-seq de forma interactiva con el paquete de Bioconductor iSEE. De tal forma que aprenderemos a generar p√°ginas web interactivas para datos de secuenciaci√≥n masiva, que es una herramienta de gran utilidad para realizar an√°lisis exploratorios. Usaremos los paquetes de Bioconductor scRNAseq y recount3 para descargar datos p√∫blicos que exploraremos con iSEE. Pre-requisitos Computadora con al menos 8 GB de memoria RAM, aplicaci√≥n Zoom https://zoom.us/download, R versi√≥n 4.0 instalada de CRAN https://cran.r-project.org/ (ver video de https://youtu.be/6knyHlUe1cM sobre como instalar R en macOS o winOS), RStudio versi√≥n 1.4 https://www.rstudio.com/products/rstudio/download/#download, y los siguientes paquetes de R: ## Para instalar paquetes if (!requireNamespace(&quot;remotes&quot;, quietly = TRUE)) { install.packages(&quot;remotes&quot;) } ## Secci√≥n plotly remotes::install_cran(&quot;palmerpenguins&quot;) remotes::install_cran(&quot;ggplot2&quot;) remotes::install_cran(&quot;plotly&quot;) ## Secci√≥n iSEE remotes::install_cran(&quot;BiocManager&quot;) BiocManager::version)() # El anterior comando debe mostrar que est√°s usando la versi√≥n 3.12 BiocManager::install(&quot;iSEE&quot;) BiocManager::install(&quot;scRNAseq&quot;) BiocManager::install(&quot;scater&quot;) BiocManager::install(&quot;Rtsne&quot;) BiocManager::install(&quot;recount3&quot;) Para qui√©n va dirigido este mini curso Este mini curso va dirigido a personas que han usado R para generar gr√°ficas est√°ticas con ggplot2. Con que sepan hacer las gr√°ficas del cap√≠tulo 2 de R Graphics Cookbook en https://r-graphics.org/chapter-quick es suficiente. Aprenderemos a usar plotly para convertir las gr√°ficas est√°ticas generadas por ggplot2 en gr√°ficas interactivas. Adem√°s, en este mini curso aprenderemos a visualizar de forma interactiva datos de RNA-seq y scRNA-seq de forma interactiva con el paquete de Bioconductor iSEE. Esto ser√° de utilidad para quienes est√°n analizando datos de transcript√≥mica con paquetes de Bioconductor. Usaremos los paquetes de scRNAseq y recount3 para descargar datos p√∫blicos. De forma indirecta esto ser√° √∫til para quienes quieren explorar datos p√∫blicamente disponibles de humano o rat√≥n. Actividades 15:45 pm a 16:00 pm: Con√©ctate a Zoom y configura tu micr√≥fono 16:00 pm a 16:05 pm: Introducci√≥n de parte de la Red Mexicana de Bioinform√°tica 16:05 pm a 16:15 pm: C√≥digo de conducta y c√≥mo usar la plataforma de Zoom 16:15 pm a 18:00 pm: Actividad del curso Organizadores Comunidad de Desarrolladores de Software en Bioinform√°tica CDSB Red Mexicana de Bioinform√°tica RMB Nodo Nacional de Bioinform√°tica en la UNAM NNB-CCG Formulario de registro https://forms.gle/xPMSkovBDveyegZt8 Informaci√≥n sesi√≥n de R Details on the R version used for making this book. The source code is available at lcolladotor/rnaseq_LCG-UNAM_2021. ## Load the package at the top of your script library(&quot;sessioninfo&quot;) ## plotly library(&quot;palmerpenguins&quot;) library(&quot;ggplot2&quot;) library(&quot;plotly&quot;) ## iSEE library(&quot;iSEE&quot;) library(&quot;scRNAseq&quot;) library(&quot;scater&quot;) library(&quot;Rtsne&quot;) library(&quot;recount3&quot;) ## Reproducibility information options(width = 120) session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.0.3 (2020-10-10) ## os Ubuntu 20.04 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Etc/UTC ## date 2021-05-05 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## AnnotationDbi 1.52.0 2020-10-27 [1] Bioconductor ## AnnotationFilter 1.14.0 2020-10-27 [1] Bioconductor ## AnnotationHub 2.22.1 2021-04-16 [1] Bioconductor ## askpass 1.1 2019-01-13 [2] RSPM (R 4.0.3) ## assertthat 0.2.1 2019-03-21 [2] RSPM (R 4.0.3) ## beachmat 2.6.4 2020-12-20 [1] Bioconductor ## beeswarm 0.2.3 2016-04-25 [1] RSPM (R 4.0.0) ## Biobase * 2.50.0 2020-10-27 [1] Bioconductor ## BiocFileCache 1.14.0 2020-10-27 [1] Bioconductor ## BiocGenerics * 0.36.1 2021-04-16 [1] Bioconductor ## BiocManager 1.30.10 2019-11-16 [1] RSPM (R 4.0.0) ## BiocNeighbors 1.8.2 2020-12-07 [1] Bioconductor ## BiocParallel 1.24.1 2020-11-06 [1] Bioconductor ## BiocSingular 1.6.0 2020-10-27 [1] Bioconductor ## BiocVersion 3.12.0 2020-04-27 [2] Bioconductor ## biomaRt 2.46.3 2021-02-09 [1] Bioconductor ## Biostrings 2.58.0 2020-10-27 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] RSPM (R 4.0.3) ## bit64 4.0.5 2020-08-30 [1] RSPM (R 4.0.3) ## bitops 1.0-6 2013-08-17 [1] RSPM (R 4.0.3) ## blob 1.2.1 2020-01-20 [1] RSPM (R 4.0.3) ## bookdown 0.21 2020-10-13 [1] RSPM (R 4.0.2) ## cachem 1.0.4 2021-02-13 [2] RSPM (R 4.0.3) ## Cairo 1.5-12.2 2020-07-07 [1] RSPM (R 4.0.3) ## circlize 0.4.12 2021-01-08 [1] RSPM (R 4.0.3) ## cli 2.3.0 2021-01-31 [2] RSPM (R 4.0.3) ## clue 0.3-58 2020-12-03 [1] RSPM (R 4.0.3) ## cluster 2.1.1 2021-02-14 [3] RSPM (R 4.0.3) ## colorspace 2.0-0 2020-11-11 [1] RSPM (R 4.0.3) ## colourpicker 1.1.0 2020-09-14 [1] RSPM (R 4.0.2) ## ComplexHeatmap 2.6.2 2020-11-12 [1] Bioconductor ## crayon 1.4.1 2021-02-08 [2] RSPM (R 4.0.3) ## curl 4.3 2019-12-02 [2] RSPM (R 4.0.3) ## data.table 1.13.6 2020-12-30 [1] RSPM (R 4.0.3) ## DBI 1.1.1 2021-01-15 [1] RSPM (R 4.0.3) ## dbplyr 2.1.0 2021-02-03 [1] RSPM (R 4.0.3) ## DelayedArray 0.16.3 2021-03-24 [1] Bioconductor ## DelayedMatrixStats 1.12.3 2021-02-03 [1] Bioconductor ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.0.3) ## dplyr 1.0.4 2021-02-02 [1] RSPM (R 4.0.3) ## DT 0.17 2021-01-06 [2] RSPM (R 4.0.3) ## ellipsis 0.3.1 2020-05-15 [2] RSPM (R 4.0.3) ## ensembldb 2.14.1 2021-04-19 [1] Bioconductor ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.0.3) ## ExperimentHub 1.16.1 2021-04-16 [1] Bioconductor ## fastmap 1.1.0 2021-01-25 [2] RSPM (R 4.0.3) ## generics 0.1.0 2020-10-31 [1] RSPM (R 4.0.3) ## GenomeInfoDb * 1.26.7 2021-04-08 [1] Bioconductor ## GenomeInfoDbData 1.2.4 2021-05-05 [1] Bioconductor ## GenomicAlignments 1.26.0 2020-10-27 [1] Bioconductor ## GenomicFeatures 1.42.3 2021-04-01 [1] Bioconductor ## GenomicRanges * 1.42.0 2020-10-27 [1] Bioconductor ## GetoptLong 1.0.5 2020-12-15 [1] RSPM (R 4.0.3) ## ggbeeswarm 0.6.0 2017-08-07 [1] RSPM (R 4.0.0) ## ggplot2 * 3.3.3 2020-12-30 [1] RSPM (R 4.0.3) ## ggrepel 0.9.1 2021-01-15 [1] RSPM (R 4.0.3) ## GlobalOptions 0.1.2 2020-06-10 [1] RSPM (R 4.0.3) ## glue 1.4.2 2020-08-27 [2] RSPM (R 4.0.3) ## gridExtra 2.3 2017-09-09 [1] RSPM (R 4.0.3) ## gtable 0.3.0 2019-03-25 [1] RSPM (R 4.0.3) ## hms 1.0.0 2021-01-13 [1] RSPM (R 4.0.3) ## htmltools 0.5.1.1 2021-01-22 [2] RSPM (R 4.0.3) ## htmlwidgets 1.5.3 2020-12-10 [2] RSPM (R 4.0.3) ## httpuv 1.5.5 2021-01-13 [1] RSPM (R 4.0.3) ## httr 1.4.2 2020-07-20 [2] RSPM (R 4.0.3) ## igraph 1.2.6 2020-10-06 [1] RSPM (R 4.0.3) ## interactiveDisplayBase 1.28.0 2020-10-27 [1] Bioconductor ## IRanges * 2.24.1 2020-12-12 [1] Bioconductor ## irlba 2.3.3 2019-02-05 [1] RSPM (R 4.0.3) ## iSEE * 2.2.4 2021-02-01 [1] Bioconductor ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.0.3) ## knitr 1.31 2021-01-27 [2] RSPM (R 4.0.3) ## later 1.1.0.1 2020-06-05 [2] RSPM (R 4.0.3) ## lattice 0.20-41 2020-04-02 [3] CRAN (R 4.0.3) ## lazyeval 0.2.2 2019-03-15 [2] RSPM (R 4.0.3) ## lifecycle 1.0.0 2021-02-15 [2] RSPM (R 4.0.3) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.0.3) ## Matrix 1.3-2 2021-01-06 [3] RSPM (R 4.0.3) ## MatrixGenerics * 1.2.1 2021-01-30 [1] Bioconductor ## matrixStats * 0.58.0 2021-01-29 [1] RSPM (R 4.0.3) ## memoise 2.0.0 2021-01-26 [2] RSPM (R 4.0.3) ## mgcv 1.8-34 2021-02-16 [3] RSPM (R 4.0.3) ## mime 0.10 2021-02-13 [2] RSPM (R 4.0.3) ## miniUI 0.1.1.1 2018-05-18 [1] RSPM (R 4.0.3) ## munsell 0.5.0 2018-06-12 [1] RSPM (R 4.0.3) ## nlme 3.1-152 2021-02-04 [3] RSPM (R 4.0.3) ## openssl 1.4.3 2020-09-18 [2] RSPM (R 4.0.3) ## palmerpenguins * 0.1.0 2020-07-23 [1] RSPM (R 4.0.2) ## pillar 1.4.7 2020-11-20 [2] RSPM (R 4.0.3) ## pkgconfig 2.0.3 2019-09-22 [2] RSPM (R 4.0.3) ## plotly * 4.9.3 2021-01-10 [1] RSPM (R 4.0.3) ## png 0.1-7 2013-12-03 [1] RSPM (R 4.0.3) ## prettyunits 1.1.1 2020-01-24 [2] RSPM (R 4.0.3) ## progress 1.2.2 2019-05-16 [1] RSPM (R 4.0.3) ## promises 1.2.0.1 2021-02-11 [2] RSPM (R 4.0.3) ## ProtGenerics 1.22.0 2020-10-27 [1] Bioconductor ## purrr 0.3.4 2020-04-17 [2] RSPM (R 4.0.3) ## R.methodsS3 1.8.1 2020-08-26 [1] RSPM (R 4.0.3) ## R.oo 1.24.0 2020-08-26 [1] RSPM (R 4.0.3) ## R.utils 2.10.1 2020-08-26 [1] RSPM (R 4.0.3) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.0.3) ## rappdirs 0.3.3 2021-01-31 [2] RSPM (R 4.0.3) ## RColorBrewer 1.1-2 2014-12-07 [1] RSPM (R 4.0.3) ## Rcpp 1.0.6 2021-01-15 [2] RSPM (R 4.0.3) ## RCurl 1.98-1.2 2020-04-18 [1] RSPM (R 4.0.3) ## recount3 * 1.0.7 2021-02-11 [1] Bioconductor ## rintrojs 0.2.2 2019-05-29 [1] RSPM (R 4.0.0) ## rjson 0.2.20 2018-06-08 [1] RSPM (R 4.0.3) ## rlang 0.4.10 2020-12-30 [2] RSPM (R 4.0.3) ## rmarkdown 2.6 2020-12-14 [1] RSPM (R 4.0.3) ## Rsamtools 2.6.0 2020-10-27 [1] Bioconductor ## RSQLite 2.2.3 2021-01-24 [1] RSPM (R 4.0.3) ## rstudioapi 0.13 2020-11-12 [2] RSPM (R 4.0.3) ## rsvd 1.0.3 2020-02-17 [1] RSPM (R 4.0.0) ## rtracklayer 1.50.0 2020-10-27 [1] Bioconductor ## Rtsne * 0.15 2018-11-10 [1] RSPM (R 4.0.3) ## S4Vectors * 0.28.1 2020-12-09 [1] Bioconductor ## scales 1.1.1 2020-05-11 [1] RSPM (R 4.0.3) ## scater * 1.18.6 2021-02-26 [1] Bioconductor ## scRNAseq * 2.4.0 2020-11-09 [1] Bioconductor ## scuttle 1.0.4 2020-12-17 [1] Bioconductor ## sessioninfo * 1.1.1 2018-11-05 [1] RSPM (R 4.0.3) ## shape 1.4.5 2020-09-13 [1] RSPM (R 4.0.3) ## shiny 1.6.0 2021-01-25 [1] RSPM (R 4.0.3) ## shinyAce 0.4.1 2019-09-24 [1] RSPM (R 4.0.0) ## shinydashboard 0.7.1 2018-10-17 [1] RSPM (R 4.0.3) ## shinyjs 2.0.0 2020-09-09 [1] RSPM (R 4.0.3) ## shinyWidgets 0.5.7 2021-02-03 [1] RSPM (R 4.0.3) ## SingleCellExperiment * 1.12.0 2020-10-27 [1] Bioconductor ## sparseMatrixStats 1.2.1 2021-02-02 [1] Bioconductor ## stringi 1.5.3 2020-09-09 [2] RSPM (R 4.0.3) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.0.3) ## SummarizedExperiment * 1.20.0 2020-10-27 [1] Bioconductor ## tibble 3.0.6 2021-01-29 [2] RSPM (R 4.0.3) ## tidyr 1.1.2 2020-08-27 [1] RSPM (R 4.0.3) ## tidyselect 1.1.0 2020-05-11 [1] RSPM (R 4.0.3) ## vctrs 0.3.6 2020-12-17 [2] RSPM (R 4.0.3) ## vipor 0.4.5 2017-03-22 [1] RSPM (R 4.0.0) ## viridis 0.5.1 2018-03-29 [1] RSPM (R 4.0.3) ## viridisLite 0.3.0 2018-02-01 [1] RSPM (R 4.0.3) ## withr 2.4.1 2021-01-26 [2] RSPM (R 4.0.3) ## xfun 0.21 2021-02-10 [2] RSPM (R 4.0.3) ## XML 3.99-0.5 2020-07-23 [1] RSPM (R 4.0.3) ## xml2 1.3.2 2020-04-23 [2] RSPM (R 4.0.3) ## xtable 1.8-4 2019-04-21 [1] RSPM (R 4.0.3) ## XVector 0.30.0 2020-10-27 [1] Bioconductor ## yaml 2.2.1 2020-02-01 [2] RSPM (R 4.0.3) ## zlibbioc 1.36.0 2020-10-27 [1] Bioconductor ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library proc.time() ## user system elapsed ## 14.936 0.582 17.784 Fecha de la √∫ltima actualizaci√≥n de esta p√°gina: 2021-05-05 04:19:02. Licencia This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. "],["exploraci√≥n-interactiva-de-datos-con-plotly.html", "1 Exploraci√≥n interactiva de datos con plotly", " 1 Exploraci√≥n interactiva de datos con plotly El c√≥digo de R de este archivo est√° disponbie v√≠a GitHub. ## Carguemos las librer√≠as que vamos a usar para esta parte del mini curso library(&quot;palmerpenguins&quot;) library(&quot;ggplot2&quot;) library(&quot;plotly&quot;) Ejemplo ## De ?plotly::ggplotly ggpenguins &lt;- qplot(bill_length_mm, body_mass_g, data = palmerpenguins::penguins, color = species ) ## Versi√≥n est√°tica creada con ggplot2 ggpenguins ## Warning: Removed 2 rows containing missing values (geom_point). ## Ahora en versi√≥n interactiva ggplotly(ggpenguins) "],["exploraci√≥n-interactiva-de-datos-transcript√≥micos-con-isee.html", "2 Exploraci√≥n interactiva de datos transcript√≥micos con iSEE 2.1 Infraestructura para datos tr√°nscriptomicos 2.2 Datos p√∫blicos 2.3 Explorando con iSEE 2.4 M√°s material", " 2 Exploraci√≥n interactiva de datos transcript√≥micos con iSEE El c√≥digo de R de este archivo est√° disponbie v√≠a GitHub. ## Carguemos las librer√≠as que vamos a usar para esta parte del mini curso ## Infraestructura library(&quot;SummarizedExperiment&quot;) library(&quot;SingleCellExperiment&quot;) ## library(&quot;SpatialExperiment&quot;) ## A partir de Bioconductor 3.13 ## que estar√° disponible a finales de mayo 2021 ## Para descargar y procesar datos library(&quot;scRNAseq&quot;) library(&quot;scater&quot;) library(&quot;Rtsne&quot;) library(&quot;recount3&quot;) ## Para visualizar los datos library(&quot;iSEE&quot;) 2.1 Infraestructura para datos tr√°nscriptomicos SummarizedExperiment SingleCellExperiment Revisemos las diapositivas 31 a 43 de la siguiente presentaci√≥n Thanks to Pete @PeteHaitch &amp; #OSCA ‚ù§Ô∏è I'm now ready for my Human Cell Atlas - Latin America presentation on ‚ÄúGetting started with #scRNA-seq analyses with @Bioconductor‚Äù üéâüìî https://t.co/nEWZcnadyhüíª https://t.co/7pXDTQRpF0#rstats @CDSBMexico @humancellatlas #LatAm pic.twitter.com/Otg8rdSlYW ‚Äî üá≤üáΩ Leonardo Collado-Torres (@lcolladotor) May 2, 2021 Incluso va m√°s all√° con SpatialExperiment Are you working with spatial transcriptomics data such as Visium from @10xGenomics? Then you'll be interested in #SpatialExperiment üì¶ led by @drighelli @lmwebr @CrowellHL with contributions by @PardoBree @shazanfar A Lun @stephaniehicks @drisso1893 üåüüìú https://t.co/r36qlakRJe pic.twitter.com/cWIiwLFitV ‚Äî üá≤üáΩ Leonardo Collado-Torres (@lcolladotor) January 29, 2021 Usamos SpatialExperiment para hacer spatialLIBD. En este proyecto particip√≥ Brenda Pardo, que es una estudiante de tercer a√±o de la LCG-EJ-UNAM en el LIIGH-UNAM. Our paper describing our package #spatialLIBD is finally out! üéâüéâüéâspatialLIBD is an #rstats / @Bioconductor package to visualize spatial transcriptomics data.‚Å∞This is especially exciting for me as it is my first paper as a first author ü¶ë.https://t.co/COW013x4GA1/9 pic.twitter.com/xevIUg3IsA ‚Äî Brenda Pardo (@PardoBree) April 30, 2021 2.2 Datos p√∫blicos scRNAseq scRNAseq es un paquete de Bioconductor que cre√≥ Aaron Lun para poder tener varios datos de ejemplo de scRNA-seq (secuenciaci√≥n masiva de ARN de c√©lulas √∫nicas) para poder demostrar sus m√©todos estad√≠sticos. Ese paquete lo usan en iSEE para obtener datos de ejemplo y tambi√©n lo usan mucho en Orchestrating Single Cell Analysis (OSCA) with Bioconductor http://bioconductor.org/books/release/OSCA/. A continuaci√≥n vamos a descargar unos datos de scRNA-seq que usan en los ejemplos de iSEE en http://bioconductor.org/packages/release/bioc/vignettes/iSEE/inst/doc/basic.html#2_Setting_up_the_data. scRNAseq usa otro paquete de Bioconductor llamado ExperimentHub para descargar los archivos y organizarlos en un lugar de tal forma que si corremos el c√≥digo otra vez en la misma computadora, no tendremos que volver a descargar los archivos. Es decir, crea un cache local. ## Descarguemos datos de ejemplo de scRNA-seq del proyecto de ## Tasic et al 2016 sce &lt;- ReprocessedAllenData(assays = &quot;tophat_counts&quot;) sce ## class: SingleCellExperiment ## dim: 20816 379 ## metadata(2): SuppInfo which_qc ## assays(1): tophat_counts ## rownames(20816): 0610007P14Rik 0610009B22Rik ... Zzef1 Zzz3 ## rowData names(0): ## colnames(379): SRR2140028 SRR2140022 ... SRR2139341 SRR2139336 ## colData names(22): NREADS NALIGNED ... Animal.ID passes_qc_checks_s ## reducedDimNames(0): ## altExpNames(1): ERCC Los datos que descargamos son datos digamos que crudos, as√≠ que necesitamos correr un par de an√°lisis usando scater para que sea m√°s interesante el ejemplo. No es el objetivo de este mini curso explicar esos pasos, aunque a grandes rasgos, nos van a ayudar a que podamos comparar las diferentes c√©lulas. Tambi√©n nos ayudar√° a visualizar las c√©lulas. ## Normalizamos los datos sce &lt;- logNormCounts(sce, exprs_values = &quot;tophat_counts&quot;) ## Obtenemos dimensiones reducidas usando primero un an√°lisis de componentes ## principales y luego con tSNE set.seed(1000) sce &lt;- runPCA(sce) sce &lt;- runTSNE(sce) ## Ahora tenemos datos de PCA y TSNE en nuestro objeto de R reducedDimNames(sce) ## [1] &quot;PCA&quot; &quot;TSNE&quot; ## Podemos ahora calcular unas variables a lo largo de nuestros genes ## tal como la expresi√≥n media del gene en las c√©lulas ## y la varianza rowData(sce)$mean_log &lt;- rowMeans(logcounts(sce)) rowData(sce)$var_log &lt;- apply(logcounts(sce), 1, var) rowData(sce) ## DataFrame with 20816 rows and 2 columns ## mean_log var_log ## &lt;numeric&gt; &lt;numeric&gt; ## 0610007P14Rik 7.9369535 9.37109 ## 0610009B22Rik 6.7572139 10.80402 ## 0610009L18Rik 0.0881306 0.40976 ## 0610009O20Rik 3.6084644 14.97973 ## 0610010F05Rik 6.5254121 13.45587 ## ... ... ... ## Zyg11a 0.0854769 0.109352 ## Zyg11b 8.9813448 3.988757 ## Zyx 2.4291810 11.860900 ## Zzef1 2.9058253 11.223440 ## Zzz3 4.4118629 15.179005 Ahora nuestro objeto sce es m√°s complejo y tiene m√°s informaci√≥n que podremos visualizar con iSEE. recount3 Para que tengan m√°s datos de ejemplo, usaremos datos del proyecto de recount3 v√≠a el cual pueden descargar informaci√≥n de m√°s de 700,000 muestras de RNA-seq de rat√≥n o humano tal como describimos en http://rna.recount.bio/. La idea es que pueden obtener objetos de R del tipo RangedSummarizedExperiment que tambi√©n podemos visualizar con iSEE. ## Revisemos todos los proyectos con datos de humano en recount3 human_projects &lt;- available_projects() ## Veamos cuantos proyectos hay nrow(human_projects) ## [1] 8742 ## Encuentra tu proyecto de inter√©s. Aqu√≠ usaremos ## SRP009615 de ejemplo proj_info &lt;- subset( human_projects, project == &quot;SRP009615&quot; &amp; project_type == &quot;data_sources&quot; ) ## Crea un objetio de tipo RangedSummarizedExperiment (RSE) ## con la informaci√≥n a nivel de genes rse_gene_SRP009615 &lt;- create_rse(proj_info) ## Explora el objeto RSE rse_gene_SRP009615 ## class: RangedSummarizedExperiment ## dim: 63856 12 ## metadata(8): time_created recount3_version ... annotation recount3_url ## assays(1): raw_counts ## rownames(63856): ENSG00000278704.1 ENSG00000277400.1 ... ENSG00000182484.15_PAR_Y ENSG00000227159.8_PAR_Y ## rowData names(10): source type ... havana_gene tag ## colnames(12): SRR387777 SRR387778 ... SRR389077 SRR389078 ## colData names(175): rail_id external_id ... recount_pred.curated.cell_line BigWigURL Los objetos de recount3 tienen ciertas propiedades que aqu√≠ no explicaremos. Pero bueno, b√°sicamente los siguientes comandos los querr√°n usar con los diferentes datos que descarguen de recount3. ## Convirtamos las cuentas por nucleotido a cuentas por lectura ## usando compute_read_counts(). ## Para otras transformaciones como RPKM y TPM, revisa transform_counts(). assay(rse_gene_SRP009615, &quot;counts&quot;) &lt;- compute_read_counts(rse_gene_SRP009615) ## Para este estudio en espec√≠fico, hagamos m√°s f√°cil de usar la ## informaci√≥n del experimento rse_gene_SRP009615 &lt;- expand_sra_attributes(rse_gene_SRP009615) colData(rse_gene_SRP009615)[ , grepl(&quot;^sra_attribute&quot;, colnames(colData(rse_gene_SRP009615))) ] ## DataFrame with 12 rows and 4 columns ## sra_attribute.cells sra_attribute.shRNA_expression sra_attribute.source_name sra_attribute.treatment ## &lt;character&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt; ## SRR387777 K562 no SL2933 Puromycin ## SRR387778 K562 yes, targeting SRF SL2934 Puromycin, doxycycline ## SRR387779 K562 no SL5265 Puromycin ## SRR387780 K562 yes targeting SRF SL3141 Puromycin, doxycycline ## SRR389079 K562 no shRNA expression SL6485 Puromycin ## ... ... ... ... ... ## SRR389082 K562 expressing shRNA tar.. SL2592 Puromycin, doxycycline ## SRR389083 K562 no shRNA expression SL4337 Puromycin ## SRR389084 K562 expressing shRNA tar.. SL4326 Puromycin, doxycycline ## SRR389077 K562 no shRNA expression SL1584 Puromycin ## SRR389078 K562 expressing shRNA tar.. SL1583 Puromycin, doxycycline 2.3 Explorando con iSEE 2.3.1 sce if (interactive()) { iSEE(sce, appTitle = &quot;Aprendiendo a usar iSEE&quot;) } Exploremos varias variables (column data) en los PCA y TSNE. ¬øQu√© variable separa los grupos de muestras? ¬øQu√© muestra tiene la mayor cantidad de n√∫mero de lecturas (NREADS)? Aprendamos a hacer _facet_s en el panel que muestra informaci√≥n de los genes (feature assay plot 1) y a ligar ese panel a la tabla con informaci√≥n de los genes Comparemos el n√∫mero de lecturas (NREADS) usando _facet_s por disecci√≥n. ¬øAlguna nos llama la atenci√≥n? Podemos usar la columna de ‚Äúpasses qc checks‚Äù. Hagamos una gr√°fica de la media (eje X) vs la varianza (eje Y) de expresi√≥n de los genes. ¬øVemos alg√∫n patr√≥n? 2.3.2 Ejercicio Ejercicio: https://lcolladotor.github.io/rnaseq_LCG-UNAM_2021/datos-de-rna-seq-a-trav%C3%A9s-de-recount3.html#ejercicio-1 if (interactive()) { iSEE(rse_gene_SRP009615, appTitle = &quot;iSEE con datos de recount3&quot;) } 2.3.3 Datos reales Datos de https://www.biorxiv.org/content/10.1101/2020.10.07.329839v1.full que pueden ver en pag√≠nas web creadas con iSEE a trav√©s de https://github.com/LieberInstitute/10xPilot_snRNAseq-human#explore-the-data-interactively. Para lograr esto subimos el resultado de iSEE a https://shinyapps.io. 2.4 M√°s material Si les llam√≥ la atenci√≥n iSEE y recount3, v√≠a https://lcolladotor.github.io/rnaseq_LCG-UNAM_2021 pueden aprender m√°s sobre estos paquetes. "]]
